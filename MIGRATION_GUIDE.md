# 🔄 راهنمای مهاجرت به دیتابیس MySQL

## 📋 مراحل مهاجرت

### مرحله 1: آماده‌سازی دیتابیس

1. **ایجاد دیتابیس MySQL:**
   ```sql
   CREATE DATABASE telegram_bot_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
   ```

2. **اجرای فایل schema:**
   ```bash
   mysql -u root -p telegram_bot_db < database_schema.sql
   ```

### مرحله 2: تنظیم اتصال دیتابیس

1. **ویرایش فایل `secure_config.php`:**
   ```php
   'DB_HOST' => 'localhost',
   'DB_NAME' => 'telegram_bot_db',
   'DB_USER' => 'root',
   'DB_PASS' => 'your_password',
   ```

### مرحله 3: اجرای مهاجرت

1. **تغییر توکن امن در `migrate_to_database.php`:**
   ```php
   if (!isset($_GET['token']) || $_GET['token'] !== 'YOUR_SECURE_TOKEN') {
   ```

2. **اجرای مهاجرت:**
   ```
   http://your-domain.com/migrate_to_database.php?token=YOUR_SECURE_TOKEN
   ```

## ⚠️ نکات مهم

### قبل از مهاجرت:
- [ ] از تمام فایل‌ها پشتیبان تهیه کنید
- [ ] دیتابیس MySQL نصب و فعال باشد
- [ ] اطلاعات اتصال صحیح باشد
- [ ] فایل‌های JSON سالم باشند

### بعد از مهاجرت:
- [ ] عملکرد ربات را تست کنید
- [ ] داده‌ها را بررسی کنید
- [ ] فایل‌های JSON قدیمی را حذف کنید
- [ ] لاگ‌ها را بررسی کنید

## 🔧 عیب‌یابی

### خطای اتصال دیتابیس:
```php
// بررسی اتصال
try {
    $pdo = new PDO("mysql:host=localhost;dbname=telegram_bot_db", "root", "");
    echo "اتصال موفق";
} catch (PDOException $e) {
    echo "خطا: " . $e->getMessage();
}
```

### خطای مهاجرت:
- فایل‌های JSON را بررسی کنید
- مجوزهای فایل را چک کنید
- لاگ‌های خطا را بررسی کنید

## 📊 آمار مهاجرت

پس از مهاجرت موفق، آمار زیر نمایش داده می‌شود:
- تعداد کاربران
- تعداد گروه‌ها
- تعداد پرداخت‌ها
- وضعیت پشتیبان‌گیری

## 🛡️ امنیت

### نکات امنیتی:
1. توکن امن را تغییر دهید
2. فایل مهاجرت را پس از استفاده حذف کنید
3. اطلاعات دیتابیس را محافظت کنید
4. فایل‌های پشتیبان را امن نگه دارید

## 📞 پشتیبانی

در صورت بروز مشکل:
1. لاگ‌های خطا را بررسی کنید
2. فایل‌های پشتیبان را بازیابی کنید
3. با تیم پشتیبانی تماس بگیرید

---

**توجه:** این مهاجرت یک‌طرفه است. پس از مهاجرت، سیستم از دیتابیس MySQL استفاده می‌کند. 